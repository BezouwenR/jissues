{# Copyright (C) 2013 - 2013 Open Source Matters, Inc. All rights reserved. #}
{# GNU General Public License version 2 or later; see LICENSE.txt#}

{% set firstPart = uri.route|split("/")|first %}

<li class="{{ "" == uri.route or "tracker" == firstPart ? "active" : "" }}">
    <a href="{{ uri.base.path }}tracker/{{ project.alias }}">
        Tracker
    </a>
</li>

{% if user.isAdmin and project.project_id %}
    <li class="dropdown {{ "projectsxx" == uri.route or "project" == firstPart ? "active" : "" }}">
        <a class="dropdown-toggle" data-toggle="dropdown" href="javascript:;">
            Project
            <span class="caret"></span>
        </a>

        <ul class="dropdown-menu">

            <li class="nav-header">{{ project.title }}</li>

            <li class="divider"><span></span></li>

            <li>
                <a href="{{ uri.base.path }}project/{{ project.project_id }}">
                    Show
                </a>
            </li>
            <li>
                <a href="{{ uri.base.path }}project/{{ project.project_id }}/edit">
                    Edit
                </a>
            </li>

            <li class="divider"><span></span></li>

            <li>
                <a href="{{ uri.base.path }}project/{{ project.project_id }}/groups">
                    Access Groups
                </a>
            </li>
        </ul>
    </li>
{% endif %}

<li class="{{ "projects" == uri.route or "projectxx" == firstPart ? "active" : "" }}">
    <a href="{{ uri.base.path }}projects">Projects</a>
</li>
<li class="{{ "users" == uri.route or "user" == firstPart ? "active" : "" }}">
    <a href="{{ uri.base.path }}users">Users</a>
</li>
<li class="{{ "markdownpreview" == uri.route ? "active" : "" }}">
    <a href="{{ uri.base.path }}markdownpreview">MDPreview</a>
</li>

{% if user.isAdmin %}
    <li class="{{ "config" == uri.route ? "active" : "" }}">
        <a href="{{ uri.base.path }}config">Config</a>
    </li>
{% endif %}

    {% if user.id %}
        <li class="dropdown pull-right">
            <a class="dropdown-toggle" data-toggle="dropdown" href="javascript:;">
                <img src="{{ uri.base.path }}images/avatars/elkuku.png" width="20px" height="20px" alt="avatar image">
                &nbsp;
                {{ user.username }}
                <span class="caret"></span>
            </a>
            <ul class="dropdown-menu">
                <li><a href="{{ uri.base.path }}user">Profile</a></li>
                <li class="divider"><span></span></li>
                <li><a href="{{ uri.base.path }}logout">Logout </a>
                </li>
            </ul>
        </li>
    {% else %}
        <li class="pull-right">
            <a class="btn-success" href="{{ loginUrl }}">Login with GitHub</a>
        </li>
    {% endif %}
