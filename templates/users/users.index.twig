{# Copyright (C) 2012 - 2014 Open Source Matters, Inc. All rights reserved. #}
{# GNU General Public License version 2 or later; see LICENSE.txt #}

{% extends "index.twig" %}

{% block title %}{{ parent() }} | Users{% endblock %}

{% block headerCSS %}
    <link rel="stylesheet" href="{{ asset('css/pagination/pagination.css', 'debug') }}" />
    <link rel="stylesheet" href="{{ asset('css/pagination/B_black.css', 'debug') }}" />
{% endblock %}

{% block content %}

    <div class="page-header">
        <h1>Users List</h1>
    </div>

    <form id="filtersForm" class="form-inline form-search" action="{{ uri.route }}">
        <div class="filters btn-toolbar clearfix">
            <div class="filter-search btn-group input-append">
                <label class="filter-search-lbl element-invisible" for="filter-search-user">Filter the list by user.</label>
                <input type="text" class="toclear search-query input-medium" name="search-user" id="filter-search-user"
                       value="{{ state.get('filter.search-user') }}"
                       title="Filter the list by user."
                       placeholder="Filter the list by user." />
                <button class="btn button-submit" type="button"><span class="icon-search"></span></button>
            </div>
            <div class="btn-group">
                <button class="btn" id="button-remove" type="button">Clear</button>
            </div>
        </div>
    </form>

    {% if pagination.pagesTotal > 1 %}
        {{ pagination.bar|raw }}
        {{ "Page %1$s of %2$s"|format(pagination.pageNo, pagination.pagesTotal)) }}
    {% endif %}

    <table class="table table-bordered table-hover">
        <tr>
            <th>Username</th>
            {% if user.isAdmin %}
                <th style="width: 10%">Actions</th>
            {% endif %}
            <th>ID</th>
        </tr>
        {% if items %}
            {% for u in items %}
                <tr>
                    <td><a href="{{ uri.base.path }}user/{{ u.id }}">{{ u.username }}</a></td>

                    {% if user.isAdmin %}
                        <td>Block...</td>
                    {% endif %}
                    <td>{{ u.id }}</td>
                </tr>
            {% endfor %}
        {% else %}
            <tr>
                <td class="center" colspan="3">
                    No items found.
                </td>
            </tr>
        {% endif %}
    </table>

    {% if pagination.pagesTotal > 1 %}
        {{ "Page %1$s of %2$s"|format(pagination.pageNo, pagination.pagesTotal)) }}
        {{ pagination.bar|raw }}
    {% endif %}

{% endblock %}

{% block JavaScriptBottom %}
    {{ parent() }}

    <script type="text/javascript">
        $('.button-submit').click(function () {
            $('#filtersForm').submit();
        });

        $('#button-remove').click(function () {
            $('[class^=toclear]').val('');
            $('#filtersForm').submit();
        });
    </script>
{% endblock %}
